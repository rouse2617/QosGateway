import{u as e,b as l,a}from"./index-JEKLdrSO.js";import{r as n,o as t,I as s,d as u,c as o,y as d,A as c,x as r,B as i,K as f,u as p,Q as m,R as _,z as v}from"./element-plus-DA67S2ud.js";import{_ as h}from"./_plugin-vue_export-helper-BCo6x5W8.js";const g={class:"logo"},w={class:"header-left"},x={class:"header-right"},y={class:"user-info"},b=h(u({__name:"MainLayout",setup(u){const h=l(),b=a(),k=e(),{connected:T}=function(){const l=n(null),a=n(!1),u=n([]),o=n(null);let d=null;function c(){const n=e();if(!n.accessToken)return;const t=`${"https:"===window.location.protocol?"wss:":"ws:"}//${window.location.host}/ws?token=${n.accessToken}`;l.value=new WebSocket(t),l.value.onopen=()=>{a.value=!0,d&&(clearTimeout(d),d=null)},l.value.onmessage=e=>{try{const l=JSON.parse(e.data);u.value.push(l),u.value.length>100&&u.value.shift(),"metrics"===l.type&&(o.value=l.data)}catch(l){}},l.value.onclose=()=>{a.value=!1,d=window.setTimeout(c,5e3)},l.value.onerror=()=>{var e;null==(e=l.value)||e.close()}}function r(){var e;d&&(clearTimeout(d),d=null),null==(e=l.value)||e.close(),l.value=null}return t(c),s(r),{connected:a,messages:u,lastMetrics:o,connect:c,disconnect:r}}(),j={"/":"仪表盘","/apps":"应用管理","/clusters":"集群配置","/connections":"连接限制","/emergency":"紧急模式"},z=o(()=>j[h.path]||"");function A(e){"logout"===e&&(k.logout(),b.push("/login"))}return(e,l)=>{const a=r("DataAnalysis"),n=r("el-icon"),t=r("Odometer"),s=r("el-menu-item"),u=r("Grid"),o=r("Connection"),b=r("Link"),j=r("Warning"),$=r("el-menu"),C=r("el-aside"),I=r("el-breadcrumb-item"),L=r("el-breadcrumb"),M=r("el-badge"),O=r("el-avatar"),S=r("el-dropdown-item"),W=r("el-dropdown-menu"),B=r("el-dropdown"),D=r("el-header"),G=r("router-view"),J=r("el-main"),K=r("el-container");return v(),d(K,{class:"layout-container"},{default:c(()=>[i(C,{width:"220px",class:"aside"},{default:c(()=>[f("div",g,[i(n,{size:"24"},{default:c(()=>[i(a)]),_:1}),l[0]||(l[0]=f("span",null,"Token 管理平台",-1))]),i($,{"default-active":p(h).path,router:"","background-color":"#001529","text-color":"#fff","active-text-color":"#409eff"},{default:c(()=>[i(s,{index:"/"},{default:c(()=>[i(n,null,{default:c(()=>[i(t)]),_:1}),l[1]||(l[1]=f("span",null,"仪表盘",-1))]),_:1}),i(s,{index:"/apps"},{default:c(()=>[i(n,null,{default:c(()=>[i(u)]),_:1}),l[2]||(l[2]=f("span",null,"应用管理",-1))]),_:1}),i(s,{index:"/clusters"},{default:c(()=>[i(n,null,{default:c(()=>[i(o)]),_:1}),l[3]||(l[3]=f("span",null,"集群配置",-1))]),_:1}),i(s,{index:"/connections"},{default:c(()=>[i(n,null,{default:c(()=>[i(b)]),_:1}),l[4]||(l[4]=f("span",null,"连接限制",-1))]),_:1}),i(s,{index:"/emergency"},{default:c(()=>[i(n,null,{default:c(()=>[i(j)]),_:1}),l[5]||(l[5]=f("span",null,"紧急模式",-1))]),_:1})]),_:1},8,["default-active"])]),_:1}),i(K,null,{default:c(()=>[i(D,{class:"header"},{default:c(()=>[f("div",w,[i(L,{separator:"/"},{default:c(()=>[i(I,{to:{path:"/"}},{default:c(()=>[...l[6]||(l[6]=[m("首页",-1)])]),_:1}),i(I,null,{default:c(()=>[m(_(z.value),1)]),_:1})]),_:1})]),f("div",x,[i(M,{"is-dot":p(T),type:p(T)?"success":"danger"},{default:c(()=>[i(n,null,{default:c(()=>[i(o)]),_:1})]),_:1},8,["is-dot","type"]),i(B,{onCommand:A},{dropdown:c(()=>[i(W,null,{default:c(()=>[i(S,{command:"logout"},{default:c(()=>[...l[7]||(l[7]=[m("退出登录",-1)])]),_:1})]),_:1})]),default:c(()=>{var e;return[f("span",y,[i(O,{size:32,icon:"User"}),f("span",null,_((null==(e=p(k).user)?void 0:e.username)||"Admin"),1)])]}),_:1})])]),_:1}),i(J,{class:"main"},{default:c(()=>[i(G)]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-e7b7f147"]]);export{b as default};
